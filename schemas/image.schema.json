{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/image.schema.json",
  "title": "Astro Image Metadata",
  "description": "Lean schema for published image pages across deep-sky and solar-system workflows.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "id",
    "title",
    "date",
    "capture_mode",
    "composition_type",
    "location_id",
    "targets",
    "equipment",
    "acquisitions",
    "assets"
  ],
  "properties": {
    "id": {
      "type": "string",
      "minLength": 3,
      "pattern": "^[a-z0-9][a-z0-9_-]*$"
    },
    "title": {
      "type": "string",
      "minLength": 3
    },
    "date": {
      "type": "string",
      "format": "date"
    },
    "capture_mode": {
      "type": "string",
      "enum": [
        "deep_sky",
        "solar_system"
      ]
    },
    "composition_type": {
      "type": "string",
      "enum": [
        "single",
        "mosaic"
      ]
    },
    "location_id": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9_-]*$"
    },
    "description": {
      "type": "string",
      "minLength": 1
    },
    "targets": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9][a-z0-9_-]*$"
      }
    },
    "equipment": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "scope_id",
        "mount_id",
        "camera_id"
      ],
      "properties": {
        "scope_id": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9_-]*$"
        },
        "mount_id": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9_-]*$"
        },
        "camera_id": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9_-]*$"
        },
        "filter_id": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9_-]*$"
        }
      }
    },
    "capture": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "focal_length_mm": {
          "type": "number",
          "exclusiveMinimum": 0
        },
        "pixel_scale_arcsec_per_px": {
          "type": "number",
          "exclusiveMinimum": 0
        },
        "gain": {
          "type": "number"
        },
        "offset": {
          "type": "number"
        },
        "notes": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "acquisitions": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "date",
          "frames",
          "exposure_s"
        ],
        "properties": {
          "session_id": {
            "type": "string",
            "minLength": 1
          },
          "date": {
            "type": "string",
            "format": "date"
          },
          "frames": {
            "type": "integer",
            "minimum": 1
          },
          "exposure_s": {
            "type": "number",
            "exclusiveMinimum": 0
          },
          "filter_id": {
            "type": "string",
            "pattern": "^[a-z0-9][a-z0-9_-]*$"
          },
          "notes": {
            "type": "string",
            "minLength": 1
          }
        }
      }
    },
    "framing": {
      "type": "object",
      "description": "Final output frame for skychart rendering. For mosaics this is the stitched frame.",
      "additionalProperties": false,
      "required": [
        "center_ra_deg",
        "center_dec_deg",
        "rotation_deg",
        "fov_width_deg",
        "fov_height_deg"
      ],
      "properties": {
        "center_ra_deg": {
          "type": "number",
          "minimum": 0,
          "maximum": 360
        },
        "center_dec_deg": {
          "type": "number",
          "minimum": -90,
          "maximum": 90
        },
        "rotation_deg": {
          "type": "number",
          "minimum": -360,
          "maximum": 360
        },
        "fov_width_deg": {
          "type": "number",
          "exclusiveMinimum": 0
        },
        "fov_height_deg": {
          "type": "number",
          "exclusiveMinimum": 0
        }
      }
    },
    "assets": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "version"
      ],
      "properties": {
        "version": {
          "type": "integer",
          "minimum": 1
        }
      }
    },
    "skychart": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "version"
      ],
      "properties": {
        "version": {
          "type": "integer",
          "minimum": 1
        },
        "caption": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "seo": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "alt": {
          "type": "string",
          "minLength": 1
        },
        "keywords": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "minLength": 1
          }
        }
      }
    }
  }
}
