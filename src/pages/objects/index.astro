---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getAllObjects, getImagesForObject } from "../../lib/content";

const objects = await getAllObjects();
const items = await Promise.all(
  objects.map(async (object) => ({
    ...object,
    imageCount: (await getImagesForObject(object.id)).length
  }))
);
---

<BaseLayout
  title="Objects | AstroCaptures"
  description="Celestial objects with linked astrophotography images."
  canonicalPath="/objects"
>
  <section class="hero">
    <h1>Objects</h1>
    <p class="muted">Browse all imaged celestial objects and open their dedicated detail pages.</p>
  </section>

  <div class="grid">
    {
      items.map((object) => (
        <a class="card" href={`/objects/${object.slug}`}>
          <div class="card-content">
            <strong>{object.title}</strong>
            <span class="muted">{object.object_type}</span>
            <span>{object.imageCount} image{object.imageCount === 1 ? "" : "s"}</span>
          </div>
        </a>
      ))
    }
  </div>
</BaseLayout>
